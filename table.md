## 什么是表格？

> 处理助手的结构化数据。

表格是一个虚拟数据库，表示原始数据源的只读视图。原始数据源可以是 csv、Excel、Postgres、MySQL、Parquet、JSON、SQLite、Snowflake、S3、BigQuery 等。

**表格**具有以下特点：
* **只读**：表格是原始数据源的只读视图，这意味着 ReByte 从不写入原始数据源。
* **部分视图**：你可以从原始数据源中选择部分列和行来创建表格。例如，你可以隐藏敏感列，或筛选出与助手无关的行。**这意味着你永远不需要更改原始数据源**。
* **瞬态**：表格是瞬态的，这意味着它不会保存在 ReByte 的数据库中，只在工具执行期间可用。这是为了确保你的数据安全和隐私。
* **可共享数据库**：可以想象数据所有者创建一个具有适当访问控制的虚拟数据库，并与其他团队成员共享，每个人都可以在共享的数据库上独立运行查询。

![img](https://res.cloudinary.com/dfjwtidnh/image/upload/v1721433515/table_kwozfl.png)

## 表格集
表格集是表格的集合，表格集是访问控制的单元，这意味着同一个表格集中的表格共享相同的访问控制，即谁可以访问表格。

## 表格生命周期

### 构建时
构建表格时需要指定两个事项：

* **定义数据源**：原始数据源，如 csv 文件、数据库表等。
* **定义表格视图**：如何将原始数据源映射到表格中，例如选择列、筛选行等。

### 查询时
你可以构建一个 **工具** 来启用自然语言查询表格。这里有三个步骤：
* **加载表格操作**：将表格数据加载到内存中，并输出完整的表格模式。
* **LLM 生成 SQL**：将表格模式与自然语言查询结合，生成 SQL 查询。你可以使用任何 LLM。未来，我们将提供一个专门用于输出 SQL 查询的模型。
* **查询表格操作**：使用生成的 SQL 查询搜索表格，并输出结果。

## 参考原始数据源
创建表格时，你需要提供一个 SQL 查询以指定要用于构建表格的原始数据源的哪个部分。

最常见的用例是包括原始数据源中的所有列和行，在这种情况下，SQL 查询就是
```sql
SELECT * FROM src
```
ReByte 始终使用 'src' 作为原始数据源的别名。
* 对于基于文件的数据源，例如 csv、Excel、Parquet，'src' 指的是文件中的所有数据。
* 对于基于数据库的数据源，例如 Postgres、MySQL，'src' 指的是整个数据库，使用 'src'.'table_name' 来引用远程数据库中的特定表。

## 数据源
* Csv
* Excel
* Postgres
* Parquet
* JSON
* SQLite

## 表格操作

在 ReByte 工具构建器中，有两个与表格相关的操作：
* **加载表格**：将表格数据加载到内存中，并输出完整的表格模式，模式包括列名、列类型、可能的值、是否可空、主键、唯一值计数等。在完整的表格模式的帮助下，几乎**所有**的 LLM 都可以生成精确的 SQL 查询。
* **查询表格**：在表格上运行 SQL 查询，并输出结果，通常 SQL 是由 LLM 操作生成的。

## 重要说明
* **数据安全**：表格是瞬态的，这意味着它不会保存在 ReByte 的数据库中，只在工具执行期间可用。但工具运行日志可能包含表格数据，工具运行日志保存在 ReByte 的数据库中，所以在表格中使用敏感数据时要小心。
* **表格大小**：目前我们没有表格大小的限制，根据我们的经验，一个包含 1M 行和 10 列的表格可以在几秒钟内处理完。
* **每次查询的最大行数**：查询表格操作中只返回前 1024 行，这样可以防止助手返回过多数据。如果你看到错误，请尝试使用更具体的查询，或在 SQL 查询中设置 LIMIT。
